<!DOCTYPE html>
<html>
<head>
    <title>MapLibre GL JS ESM Test</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="dist/maplibre-gl.css">
    <style>
        body { margin: 0; padding: 0; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            background: white;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            z-index: 1;
        }
    </style>
</head>
<body>
    <div id="info">Loading ESM module...</div>
    <div id="map"></div>
    
    <script type="module">
        // Import MapLibre GL JS as ESM
        import maplibregl from './dist/maplibre-gl-dev.mjs';
        
        const info = document.getElementById('info');
        
        // Display module info
        info.innerHTML = `
            <strong>ESM Module Loaded</strong><br>
            Version: ${maplibregl.getVersion ? maplibregl.getVersion() : 'N/A'}<br>
            Map class: ${maplibregl.Map ? '✓' : '✗'}<br>
            Worker URL: ${maplibregl.getWorkerUrl ? maplibregl.getWorkerUrl() : 'Not set'}<br>
        `;
        
        // Create a simple map
        try {
            const map = new maplibregl.Map({
                container: 'map',
                style: {
                    version: 8,
                    sources: {
                        osm: {
                            type: 'raster',
                            tiles: ['https://tile.openstreetmap.org/{z}/{x}/{y}.png'],
                            tileSize: 256,
                            attribution: '© OpenStreetMap contributors'
                        }
                    },
                    layers: [{
                        id: 'osm',
                        type: 'raster',
                        source: 'osm'
                    }]
                },
                center: [0, 0],
                zoom: 2
            });
            
            map.on('load', () => {
                info.innerHTML += 'Map loaded successfully! ✓';
            });
            
            map.on('error', (e) => {
                info.innerHTML += `<br>Error: ${e.error.message}`;
            });
        } catch (e) {
            info.innerHTML += `<br>Failed to create map: ${e.message}`;
        }
    </script>
</body>
</html>